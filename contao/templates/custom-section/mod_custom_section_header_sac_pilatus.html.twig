<!-- indexer::stop -->
<div class="header-custom-template">
    <div class="header-navbar-row-0">
        <div class="inner d-flex ps-3 pe-3 pt-2 pb-2 align-items-center">
            {# small screens #}
            <div class="ms-0 me-auto d-flex d-sm-none align-items-center header-backoffice-link">{{ insert_tag('link_open::geschaeftsstelle')|raw }}<i class="fa-light fa-envelope"></i>{{ insert_tag('link_close')|raw }}</div>
            {# large screens #}
            <div class="ms-0 me-auto d-none d-sm-flex align-items-center header-backoffice-link">{{ insert_tag('link_open::geschaeftsstelle')|raw }}<i class="fa-light fa-envelope me-2 align-bottom"></i>Geschäftsstelle{{ insert_tag('link_close')|raw }}</div>

            <div class="ms-auto me-0 d-flex align-items-center">
                {% if has_logged_in_frontend_user() %}
                    <a href="{{ path('contao_frontend_logout') }}" data-href="{{ path('contao_frontend_logout') }}" data-targetpath="{{ app.request.getSchemeAndHttpHost() }}" data-logout-label="du wirst abgemeldet …" class="trigger-ids-kill-session header-logout-link m-0 ms-2 me-4" title="Abmelden/Logout"><i class="fa-light fa-sign-out-alt me-2"></i>Abmelden</a>

                    <div class="ms-2 d-none d-sm-block small">Angemeldet als: {{ insert_tag('user::firstname') }} {{ insert_tag('user::lastname') }}</div>
                    <div class="ms-3 small">
                        <a href="{{ insert_tag('link_url::276') }}" title="Mitgliederprofil bearbeiten">
                            {% set user = get_logged_in_frontend_user() %}
                            {{ insert_tag('image::'~getAvatarResourcePath(user)~'?width=32&height=32&mode=crop&class=rounded-circle')|raw }}
                        </a>
                    </div>
                    {% if has_logged_in_frontend_user() %}
                        <a href="{{ insert_tag('link_url::276') }}" class="btn btn-sm btn-danger ms-2" title="Mitgliederprofil bearbeiten"><i class="fa-regular fa-cog"></i><span class="d-inline">&nbsp;Profil</span></a>
                    {% endif %}
                {% endif %}

                {% if not has_logged_in_frontend_user() %}
                    <div class="header-login-placeholder d-inline position-relative" style="width:120px">
                        <span class="placeholder-glow">
                            <span class="placeholder col-2"></span>
                            <span class="placeholder col-9"></span>
                        </span>
                    </div>
                    <button aria-haspopup="dialog" onclick="window.location.href='{{ insert_tag('link_url::member-login') }}'" class="header-login-button p-0 d-none ms-2 me-0 mt-2 mb-2" data-sac-login-toggle="modal" tabindex="0"><i class="fa-light fa-sign-in me-2"></i>Mitglieder-Login</button>
                    <script{{ attrs().setIfExists('nonce', csp_nonce('script-src')) }}>
                        document.addEventListener("BootstrapModalReady", (event) => {
                            document.querySelector('.header-login-placeholder').remove();
                            document.querySelector('.header-login-button').classList.remove('d-none');
                            document.querySelector('.header-login-button').removeAttribute('onclick');
                        });
                    </script>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="header-navbar-row-1">
        <div class="inner hide-from-print navbar navbar-expand navbar-dark flex-md-row bd-navbar align-items-center pt-0 pt-sm-2 pb-0 pb-sm-2">
            <div class="navbar-brand ms-3">
                <a href="{{ app.request.getSchemeAndHttpHost() }}" title="Gehe zur Startseite">
                    <img src="/files/theme-sac-pilatus/images/logos/logo-header.svg" class="logo-header" alt="Logo SAC-Pilatus">
                </a>
            </div>

            <!-- NAVBAR-START -->
            <div class="navbar-header d-none d-xl-flex align-items-center">
                <!-- indexer::continue -->
                {{ insert_tag('insert_module::307')|raw }}
            </div>
            <!-- indexer::stop -->
            <!-- NAVBAR-END -->

            <div class="header-button-container ms-auto d-flex align-items-center justify-content-end">

                <a href="{{ insert_tag('link_url::touren-trainings-und-anlaesse') }}" class="d-none d-md-block btn btn-primary ms-2"><i style="width:20px;font-size:1rem !important;" class="fa-regular fa-mountains"></i> Touren</a>
                <a href="{{ insert_tag('link_url::kurse') }}" class="d-none d-md-block btn btn-danger ms-2 me-2"><i style="width:20px;font-size:1rem !important;" class="fa-regular fa-signal"></i> Kurse</a>

                <!-- Searchbar toggler -->
                <button class="btn btn-lg btn-link ps-2 ps-sm-3 pe-2 pe-2 pe-sm-3 ms-3 search-toggler" data-action="search-bar-toggle" aria-label="Suche" tabindex="0">
                    <i class="fa-light fa-search" aria-label="Suche" title="Suche"></i>
                </button>
                <!-- End Searchbar toggler -->

                <!-- Navbar toggler mobile -->
                <button class="navigation-toggler d-xl-none btn btn-lg btn-link ps-2 ps-sm-3 pe-2 pe-2 pe-sm-3 ms-2" aria-label="Navigation öffnen" tabindex="0">
                    <i class="fa-light fa-lg fa-bars"></i>
                </button>
                <!-- End Navbar toggler mobile -->

            </div>
        </div>
    </div>

    <!-- Search module -->
    <!-- indexer::continue -->
    {{ insert_tag('insert_module::353')|raw }}
    <!-- indexer::stop -->

</div>

<!-- Login Modal -->
<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabelLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="bg-white modal-header">
                <h3 class="modal-title">Mitglieder Login</h3>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Login-Formular schliessen" tabindex="0"></button>
            </div>
            <div class="modal-body">
                <div class="mt-0">
                    <p class="mt-0">
                        Als Mitglied der SAC Sektion Pilatus kannst du dich mit deinem Login vom <strong>SAC/CAS-Portal</strong> hier anmelden.
                    </p>

                    <!-- indexer::continue -->
                    {{ insert_tag('insert_module::396')|raw }}
                    <!-- indexer::stop -->

                    <p>
                        Verwende deine <strong>Mitgliedernummer oder E-Mail</strong> und <strong>Passwort</strong> von deinem SAC/CAS-Konto.
                    </p>

                    <h5 class="mt-4 d-block">Was ist das SAC-Konto / SAC-Portal?</h5>
                    <p>Auf der nachfolgenden SAC/CAS-Seite werden die häufigsten Fragen rund um das Login des SAC-Portals beantwortet:</p>

                    <div class="d-block mt-1">
                        <p><a class="btn btn-sm btn-outline-danger" href="https://www.sac-cas.ch/de/meta/faq/faq-sac-konto-/-sac-portal/" target="_blank" download="SAC Login FAQ">Häufige Fragen zum SAC-Portal</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script{{ attrs().setIfExists('nonce', csp_nonce('script-src')) }}>
    /**
     * Bootstrap does not hide the modal backdrop,
     * when clicking the hide button,
     * so we have to do remove it manually.
     *
     * @type {HTMLElement}
     */
    const loginModal = document.getElementById('loginModal');

    loginModal.addEventListener('hidden.bs.modal', event => {
        const modalBackdrops = document.querySelectorAll('body > .modal-backdrop.show');

        for (const modalBackdrop of modalBackdrops) {
            modalBackdrop.remove();
        }

        document.querySelector('body').removeAttribute('style');
    });
</script>
<!-- indexer::continue -->
